### SnapRAID Daemon Config
#
# 1. Manual Edits: You can safely edit this file at any time. To apply changes
#    without restarting the process, send a SIGHUP signal, for example by
#    running 'systemctl reload snapraidd'.
# 2. API Updates: Changes made through the REST interface are applied
#    instantly and saved to this file while preserving your comments.
# 3. Conflict Warning: If you edit this file manually while the daemon is
#    running, remember to RELOAD before making any API changes to prevent
#    the daemon from overwriting your manual edits with its memory state.
#

### Network & REST API
# The net_enabled switch acts as the master toggle for the HTTP interface.
# If this is set to 0 or left blank, the daemon operates in a secure,
# local-only mode and will not open any network ports. Setting this to 1
# enables the REST API.
# This option cannot be set from the REST API.
net_enabled = 0

# The net_port defines the specific IP address and port the daemon binds to.
# Format: [IP_ADDRESS:]PORT[s].
# IP_ADDRESS can be an IPv4 (e.g., 127.0.0.1) or an IPv6 address wrapped
# in brackets (e.g., [::1]). PORT is a standard number.
# If left unset, the daemon defaults to 127.0.0.1:8080.
# This option cannot be set from the REST API.
#
# Examples:
#   "127.0.0.1:8080"       - IPv4 localhost only (Recommended).
#   "8080"                 - All IPv4 interfaces (0.0.0.0).
#   "[::1]:8080"           - IPv6 loopback only.
#   "127.0.0.1:8080,8081"  - Listen on multiple ports.
net_port = 127.0.0.1:8080

# The net_acl restricts API access to specific client IPs.
# Format: A comma-separated list of [+/-][IP/MASK].
# A '+' allows and '-' denies. Subnets use CIDR notation (e.g., /24).
# If unset, the daemon defaults to +127.0.0.1. If any rules are set,
# the server denies everything by default. The last matching rule wins.
# This option cannot be set from the REST API.
#
# Examples:
#   "+127.0.0.1,+::1"          - Allow IPv4 and IPv6 loopback.
#   "+192.168.1.0/24"          - Allow local subnet only.
#   "-0.0.0.0/0,+127.0.0.1"    - Explicit deny-all followed by allow.
net_acl = +127.0.0.1

### Automation & Maintenance
# Use maintenance_schedule to define when the automated maintenance 
# sequence—consisting of a sync, a scrub, and a report—should occur. 
# Automated maintenance is disabled if this is unset.
# Format: "daily HH:MM" or "weekly <Day> HH:MM".
# Hours (HH) use 24-hour format (00-23). Day is the short name (Mon, Tue, etc.).
#
# Examples:
#   "daily 02:00"              - Run every night at 2 AM.
#   "weekly Mon 03:00"         - Run every Monday morning at 3 AM.
maintenance_schedule = daily 02:00

# Defines the maximum number of deleted or missing files allowed before 
# a 'sync' operation is aborted to prevent accidental parity loss. 
# This safety mechanism is enforced during 'scheduled_run' tasks and 
# the '/api/v1/maintenance' API sequence. 
# It is bypassed for standalone '/api/v1/sync' API requests to allow 
# manual overrides. 
# Set to 0 to disable this check.
sync_threshold_deletes = 50

# Defines the maximum number of modified or updated files allowed before 
# a 'sync' operation is aborted. 
# This safety mechanism is enforced during 'scheduled_run' tasks and 
# the '/api/v1/maintenance' API sequence. 
# It is bypassed for standalone '/api/v1/sync' API requests to allow 
# manual overrides. 
# Set to 0 to disable this check.
sync_threshold_updates = 500

# If set to 1 run sync with the prehash option to prevent silent errors due
# faulty memory on files not yet hashed.
# If this is missing or set to 0, no prehash is used.
sync_prehash = 1

# If set to 1 run sync also in precence of files with zero size that were no
# zero before
# If this is missing or set to 0, the sync doesn't run in presence of such
# files.
sync_force_zero = 1

# After a sync completes, the scrub_percentage determines how much of the
# array is verified.
# If this is missing or set to 0, the scrub phase is skipped entirely.
scrub_percentage = 8

# Do not scrub blocks newer than the specified number of days.
# If this is missing, or set to 0, the scrub does not apply a selection based
# on the age of the block.
scrub_older_than = 10

### Disk Monitoring & Power
# The probe_interval_minutes setting controls how often the daemon checks
# SMART attributes, provided the disks are already spinning. If this is
# set to 0 or left blank, SMART monitoring is disabled.
probe_interval_minutes = 15

# To save power, spindown_idle_minutes will automatically spin down disks
# after the specified period of inactivity. If unset, the daemon will not
# manage disk power states.
spindown_idle_minutes = 60

# Specify absolute paths for script_pre_run and script_post_run to trigger
# custom logic immediately before or after SnapRAID activity.
#
# SECURITY REQUIREMENTS:
# 1. The path MUST be absolute (starting with /).
# 2. The script file MUST NOT be world-writable (recommended: 700 or 755).
# 3. The script owner MUST match the user running the daemon or be root.
# 4. The script MUST contain a valid shebang (e.g., #!/bin/sh)
#
# These remain inactive if no paths are defined.
#script_pre_run = /usr/local/bin/pre-snapraid.sh
#script_post_run = /usr/local/bin/post-snapraid.sh

# The user account used for executing script_pre_run and script_post_run.
# If missing or left blank, the scripts run with the daemon's current privileges.
# This option cannot be set from the REST API.
script_run_as_user = nobody

### Logging & Retention
# The log_directory defines where the output of individual SnapRAID
# commands is stored. If this is not defined, command output is not
# saved to persistent files.
# The log directory should already exists.
log_directory = /var/log/snapraid

# To prevent your storage from filling up, log_retention_days sets the
# age at which old command logs are deleted. Logs are kept indefinitely
# if this is set to 0 or left unset.
log_retention_days = 30

### Notifications
# --- System Log (syslog/journald) ---
# When notify_syslog_enabled is set to 1, daemon activity is sent to the
# OS system log. While lifecycle events like starting and stopping are
# always captured, task-related messages are filtered by the level below.
notify_syslog_enabled = 1

# Sets the minimum severity for syslog task entries.
# Possible values: info, warning, error, critical. (Default: critical)
notify_syslog_level = info

# Runs ONLY if the task was successful (exit code 0).
# Ideal for 'Dead Man's Snitch' or Healthchecks.io.
# If this ping stops, it means the server is down or the task is failing.
#notify_heartbeat = curl -fsS --max-time 30 --retry 3 https://hc-ping.com/550e8400-e29b-41d4

# This command is triggered after every task, but is ONLY executed if the
# task's result matches the 'notify_result_level' defined below.
# It receives a structured text report via stdin.
#notify_result = curl -fsS --max-time 30 --retry 3 -H "Content-Type: text/plain" -H "Title: SnapRAID Task Report" --data-binary @- https://ntfy.sh/your_private_topic

# Controls the filter for 'notify_result'. The notification is sent only
# if the task result is equal to or more severe than this level.
# Values: info (always), warning, error, critical (default).
# Example: If set to 'error', notifications are sent for errors and
# critical failures, but NOT for successful 'info' runs.
notify_result_level = error

# Use notify_email_recipient to send reports to a local system email address.
#notify_email_recipient = admin@example.com

# Sets the minimum severity for email reports.
# Possible values: info, warning, error, critical. (Default: critical)
notify_email_level = warning

# The user account used for heartbeat, apprise and mail notifications.
# If missing or left blank, the task runs with the daemon's current privileges.
# This option cannot be set from the REST API.
notify_run_as_user = nobody

# If set to 1, the daemon will log a detailed list of file changes discovered
# before the sync begins.
# If this is missing or set to 0, no difference report is generated
notify_differences = 1
